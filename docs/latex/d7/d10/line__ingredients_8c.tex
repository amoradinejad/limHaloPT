\hypertarget{line__ingredients_8c}{}\doxysection{line\+\_\+ingredients.\+c File Reference}
\label{line__ingredients_8c}\index{line\_ingredients.c@{line\_ingredients.c}}


Documented line\+\_\+ingredients module.  


{\ttfamily \#include \char`\"{}header.\+h\char`\"{}}\newline
Include dependency graph for line\+\_\+ingredients.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{dc/d32/line__ingredients_8c__incl}
\end{center}
\end{figure}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{struct_line}{Line}} $\ast$ \mbox{\hyperlink{line__ingredients_8c_aa4696edc9829e9a3c2c1012a3e9d9dbe}{Line\+\_\+alloc\+\_\+init}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, long line\+\_\+type, size\+\_\+t npoints\+\_\+interp, double M\+\_\+min, long mode\+\_\+mf)
\begin{DoxyCompactList}\small\item\em Allocate the memory and initialize the the line structure. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{line__ingredients_8c_a255599f7e846dd569f4ce4c946157dec}{Line\+\_\+free}} (struct \mbox{\hyperlink{struct_line}{Line}} $\ast$Lx)
\begin{DoxyCompactList}\small\item\em Free the line structure. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{line__ingredients_8c_a0b51100183117f08ce0cfa9428fa72e4}{Line\+\_\+evaluate}} (struct \mbox{\hyperlink{struct_line}{Line}} $\ast$Lx, double $\ast$zz, double $\ast$res)
\begin{DoxyCompactList}\small\item\em Allocate the memory and initialize the the line structure. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{line__ingredients_8c_ae44a16b587a91c0ea92dea263d20a5be}{mult\+\_\+func}} (double sigma, long mode\+\_\+mf)
\begin{DoxyCompactList}\small\item\em Compute the multiplicity function needed to compute the halo mass function Three models are implemented\+: Press-\/\+Schechter, Sheth-\/\+Tormen and Tinker see Pillepich et al arxiv\+: 0811.\+4176 for the expressions. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{line__ingredients_8c_a2ca7a5add6fca8bd94165085f351f702}{mass\+\_\+func}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double M, double z, long mode\+\_\+mf)
\begin{DoxyCompactList}\small\item\em Compute the halo mass function for Press-\/\+Schechter, Sheth-\/\+Tormen and Tinker models see Pillepich et al arxiv\+: 0811.\+4176 for the expressions. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{line__ingredients_8c_a60bf4840dc0204947ec426719979065e}{mass\+\_\+func\+\_\+sims}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double M, double z, long mode\+\_\+mf)
\begin{DoxyCompactList}\small\item\em Read in the measured mass function of Hidden-\/valey sims and build an interpolator for HMF(\+M) for a fixed redshift. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{line__ingredients_8c_a5e747f325f7196b6c042ddcfdfb17fab}{halo\+\_\+bias}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double M, double z, long mode\+\_\+mf, double $\ast$bias\+\_\+arr)
\begin{DoxyCompactList}\small\item\em computes the halo biases for three mass functions, press-\/schecter, Sheth-\/\+Tormen, and Tinker mass functions \end{DoxyCompactList}\item 
void \mbox{\hyperlink{line__ingredients_8c_a5cbbc00460ea99c79cf2f2f7efd0af5a}{log\+SFR\+\_\+\+Behroozi\+\_\+read}} (double $\ast$z\+\_\+arr, double $\ast$log\+M\+\_\+arr, double $\ast$log10\+SFR)
\begin{DoxyCompactList}\small\item\em Read in the file for the star formation rate byy Behroozi et al 2013. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{line__ingredients_8c_aebdf0211b161d65ccf44536629df2b02}{log\+SFR\+\_\+alloc\+\_\+init}} ()
\begin{DoxyCompactList}\small\item\em Allocate memory and initialize the 2d interpolator for the star formation rate of Behroozi et al 2013 as a function of halo mass and redshift. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{line__ingredients_8c_a6d006053a4f4af3c50b5c9a0b6365a8d}{SFR\+\_\+\+Behroozi\+\_\+free}} ()
\begin{DoxyCompactList}\small\item\em Free the memory allocated to the interpolators of star formation rate by Behroozi et al 2013. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{line__ingredients_8c_a728fd0a19bc34645b8f8218464d178ef}{log\+SFR\+\_\+\+Behroozi}} (double logM, double z)
\begin{DoxyCompactList}\small\item\em Evaluate the SFR interpolator object for a given value of mass and redshift. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{line__ingredients_8c_a1d5765167555f21d8ae5eba187eb2aa8}{luminosity}} (double M, double z, long mode\+\_\+lum)
\begin{DoxyCompactList}\small\item\em Compute the line specific luminosity in unit of solar luminosity For CO ladder, I am using the fits in Table 4 of ??? et al ar\+Xiv\+:1508.\+05102, while for CII we use Silva et al ar\+Xiv\+: \end{DoxyCompactList}\item 
int \mbox{\hyperlink{line__ingredients_8c_ab82b15c827d1213a94e3ff9ce4ddad32}{mass\+\_\+moment1\+\_\+integ}} (unsigned nd, const double $\ast$x, void $\ast$p, unsigned fdim, double $\ast$fvalue)
\begin{DoxyCompactList}\small\item\em Compute the first luminosityy-\/weighted mass moment. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{line__ingredients_8c_a4024cda73f4069d07113edd77ae35d4e}{mass\+\_\+moment1}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double z, double M\+\_\+min, long mode\+\_\+mf, long mode\+\_\+lum)
\begin{DoxyCompactList}\small\item\em in unit of M\+\_\+sun/\+Mpc$^\wedge$3 \end{DoxyCompactList}\item 
int \mbox{\hyperlink{line__ingredients_8c_af293c79ca858df80dcc0ef9f29448059}{mass\+\_\+moment2\+\_\+integ}} (unsigned nd, const double $\ast$x, void $\ast$p, unsigned fdim, double $\ast$fvalue)
\begin{DoxyCompactList}\small\item\em Compute the second luminosityy-\/weighted mass moment. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{line__ingredients_8c_a905f3fe9b824af5ce217f36af3c767e5}{mass\+\_\+moment2}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double z, double M\+\_\+min, long mode\+\_\+mf, long mode\+\_\+lum)
\begin{DoxyCompactList}\small\item\em in unit of M\+\_\+sun/\+Mpc$^\wedge$3 \end{DoxyCompactList}\item 
int \mbox{\hyperlink{line__ingredients_8c_a609c2a4b205e7f497d4b96657510fd5f}{bias\+\_\+lum\+\_\+weighted\+\_\+integ}} (unsigned nd, const double $\ast$x, void $\ast$p, unsigned fdim, double $\ast$fvalue)
\begin{DoxyCompactList}\small\item\em Compute the luminosityy-\/weighted linear and quadratic line biases. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{line__ingredients_8c_aa050a054d3724145e3b46788bf279c79}{bias\+\_\+lum\+\_\+weighted}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double z, double M\+\_\+min, long mode\+\_\+mf, long mode\+\_\+lum, double $\ast$result)
\item 
double \mbox{\hyperlink{line__ingredients_8c_ac62e7dccfe1892b60f1709957e93d48c}{p\+\_\+sig\+\_\+shot\+\_\+integrand}} (double x, void $\ast$par)
\begin{DoxyCompactList}\small\item\em Model from Keating et al 2016 to account for the observed variation in halo activity, i.\+e. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{line__ingredients_8c_aac555bd341b096dfecd3cd915747b5a4}{p\+\_\+sig\+\_\+shot}} (double scatter)
\item 
double \mbox{\hyperlink{line__ingredients_8c_a051e4cade75852a7abff94bce70a0307}{p\+\_\+sig\+\_\+\+Tbar\+\_\+integrand}} (double x, void $\ast$par)
\begin{DoxyCompactList}\small\item\em Model from Keating et al 2016 to account for the observed variation in halo activity, i.\+e. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{line__ingredients_8c_a2bfb013c5be4f1c6d1ea0b91146b5f1c}{p\+\_\+sig\+\_\+\+Tbar}} (double scatter)
\item 
void \mbox{\hyperlink{line__ingredients_8c_a3a13aa566fb639abeb29eae43e5fcfa8}{line\+\_\+bias}} (struct \mbox{\hyperlink{struct_line}{Line}} $\ast$Lx, double z, double $\ast$result)
\begin{DoxyCompactList}\small\item\em Compute the linear and quadratic line biases, accounting ffor the normalization w.\+r.\+t. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{line__ingredients_8c_a01a848b612006614576adc49385076cf}{mean\+\_\+intens}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, size\+\_\+t line\+\_\+id, double z)
\begin{DoxyCompactList}\small\item\em Compute the line mean intensity in unit of erg Mpc$^\wedge$-\/2 Sr$^\wedge$-\/1. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{line__ingredients_8c_a8badf96f7e0696daa78b2f6aeeda8a08}{Tbar\+\_\+line}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, size\+\_\+t line\+\_\+id, double z)
\begin{DoxyCompactList}\small\item\em Compute the mean brightness temprature of CO in unit of microK, compared with Pullen et al and Lidz et al 2011. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structglobals}{globals}} \mbox{\hyperlink{line__ingredients_8c_a61c6674f2b410e126a682325ce5360c0}{gb}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Documented line\+\_\+ingredients module. 

This module includes functions that are needed for computing the line clustering and shot contributions.

Azadeh Moradinezhad Dizgah, November 4th 2021

In summary, the following functions can be called from other modules\+:
\begin{DoxyEnumerate}
\item \mbox{\hyperlink{line__ingredients_8c_aa4696edc9829e9a3c2c1012a3e9d9dbe}{Line\+\_\+alloc\+\_\+init()}} allocate memory and initizlized the line structure which contains 4 interpolators for first and second mass moments and linear and quadratic line biases.
\item \mbox{\hyperlink{line__ingredients_8c_a255599f7e846dd569f4ce4c946157dec}{Line\+\_\+free()}} frees the memory allocated to line structure
\item \mbox{\hyperlink{line__ingredients_8c_a0b51100183117f08ce0cfa9428fa72e4}{Line\+\_\+evaluate()}} evaluates the interpolators initialized in \mbox{\hyperlink{line__ingredients_8c_aa4696edc9829e9a3c2c1012a3e9d9dbe}{Line\+\_\+alloc\+\_\+init()}}
\item \mbox{\hyperlink{line__ingredients_8c_ae44a16b587a91c0ea92dea263d20a5be}{mult\+\_\+func()}} computes the multiplicity function needed for computing the halo mass function
\item \mbox{\hyperlink{line__ingredients_8c_a2ca7a5add6fca8bd94165085f351f702}{mass\+\_\+func()}} computes the halo mass finction. Three options are available, Press-\/\+Schecter, Sheth-\/\+Tormen, Tinker
\item \mbox{\hyperlink{line__ingredients_8c_a60bf4840dc0204947ec426719979065e}{mass\+\_\+func\+\_\+sims()}} reads in the measured mass function on Hidden-\/\+Valley simulations by Farnik, and convert it to compare with the theoretical predictions
\item \mbox{\hyperlink{line__ingredients_8c_a5e747f325f7196b6c042ddcfdfb17fab}{halo\+\_\+bias()}} computes the halo biases assuming the above theoretical predictions of the halo mass function
\item \mbox{\hyperlink{line__ingredients_8c_a5cbbc00460ea99c79cf2f2f7efd0af5a}{log\+SFR\+\_\+\+Behroozi\+\_\+read()}} reeds in the data file of Behroozi 2013 for SFR(\+M,z)
\item \mbox{\hyperlink{line__ingredients_8c_aebdf0211b161d65ccf44536629df2b02}{log\+SFR\+\_\+alloc\+\_\+init()}} allocates memory for 2d interpolator of log\+SFR(\+M,z)
\item SFR\+\_\+behroozi\+\_\+free() frees the memory allocated to log\+SFR interpolator
\item \mbox{\hyperlink{line__ingredients_8c_a728fd0a19bc34645b8f8218464d178ef}{log\+SFR\+\_\+\+Behroozi()}} evaluates the log\+SFR\+\_\+\+Behroozi interpolator
\item \mbox{\hyperlink{line__ingredients_8c_a1d5765167555f21d8ae5eba187eb2aa8}{luminosity()}} computes the line luminosity
\item \mbox{\hyperlink{line__ingredients_8c_a4024cda73f4069d07113edd77ae35d4e}{mass\+\_\+moment1()}} computes the first mass moment
\item \mbox{\hyperlink{line__ingredients_8c_a905f3fe9b824af5ce217f36af3c767e5}{mass\+\_\+moment2()}} computes the first mass moment
\item \mbox{\hyperlink{line__ingredients_8c_aa050a054d3724145e3b46788bf279c79}{bias\+\_\+lum\+\_\+weighted()}} computes the luminosity-\/weighetd line bias
\item \mbox{\hyperlink{line__ingredients_8c_aac555bd341b096dfecd3cd915747b5a4}{p\+\_\+sig\+\_\+shot()}} computes the coefficient accounting for the scatter in L(\+M) in shot noise
\item \mbox{\hyperlink{line__ingredients_8c_a2bfb013c5be4f1c6d1ea0b91146b5f1c}{p\+\_\+sig\+\_\+\+Tbar()}} computes the coefficient accounting for the scatter in L(\+M) in mean brightness temprature
\item \mbox{\hyperlink{line__ingredients_8c_a01a848b612006614576adc49385076cf}{mean\+\_\+intens()}} compues the mean intensity of the line
\item \mbox{\hyperlink{line__ingredients_8c_a8badf96f7e0696daa78b2f6aeeda8a08}{Tbar\+\_\+line()}} compues the mean brightness temprature of the line 
\end{DoxyEnumerate}

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{line__ingredients_8c_aa050a054d3724145e3b46788bf279c79}\label{line__ingredients_8c_aa050a054d3724145e3b46788bf279c79}} 
\index{line\_ingredients.c@{line\_ingredients.c}!bias\_lum\_weighted@{bias\_lum\_weighted}}
\index{bias\_lum\_weighted@{bias\_lum\_weighted}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{bias\_lum\_weighted()}{bias\_lum\_weighted()}}
{\footnotesize\ttfamily void bias\+\_\+lum\+\_\+weighted (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{double}]{z,  }\item[{double}]{M\+\_\+min,  }\item[{long}]{mode\+\_\+mf,  }\item[{long}]{mode\+\_\+lum,  }\item[{double $\ast$}]{result }\end{DoxyParamCaption})}

In units of solar mass;

In units of solar massHere is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_aa050a054d3724145e3b46788bf279c79_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_aa050a054d3724145e3b46788bf279c79_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_a609c2a4b205e7f497d4b96657510fd5f}\label{line__ingredients_8c_a609c2a4b205e7f497d4b96657510fd5f}} 
\index{line\_ingredients.c@{line\_ingredients.c}!bias\_lum\_weighted\_integ@{bias\_lum\_weighted\_integ}}
\index{bias\_lum\_weighted\_integ@{bias\_lum\_weighted\_integ}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{bias\_lum\_weighted\_integ()}{bias\_lum\_weighted\_integ()}}
{\footnotesize\ttfamily int bias\+\_\+lum\+\_\+weighted\+\_\+integ (\begin{DoxyParamCaption}\item[{unsigned}]{nd,  }\item[{const double $\ast$}]{x,  }\item[{void $\ast$}]{p,  }\item[{unsigned}]{fdim,  }\item[{double $\ast$}]{fvalue }\end{DoxyParamCaption})}



Compute the luminosityy-\/weighted linear and quadratic line biases. 

The normalization of first mass moment is not included yet. The function \mbox{\hyperlink{line__ingredients_8c_a609c2a4b205e7f497d4b96657510fd5f}{bias\+\_\+lum\+\_\+weighted\+\_\+integ()}} is the integrand and \mbox{\hyperlink{line__ingredients_8c_aa050a054d3724145e3b46788bf279c79}{bias\+\_\+lum\+\_\+weighted()}} computes the bias


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: pointer to cosmology structure \\
\hline
{\em z} & Input\+: redshift \\
\hline
{\em M\+\_\+min} & Input\+: minimum halo mass \\
\hline
{\em mode\+\_\+mf} & Input\+: model of halo mass function to consider, PSC, ST, TR \\
\hline
{\em mode\+\_\+lum} & Inpute\+: which luminosity model, basically which line considered \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
un-\/normalized line bias ~\newline
 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a609c2a4b205e7f497d4b96657510fd5f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a609c2a4b205e7f497d4b96657510fd5f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_a5e747f325f7196b6c042ddcfdfb17fab}\label{line__ingredients_8c_a5e747f325f7196b6c042ddcfdfb17fab}} 
\index{line\_ingredients.c@{line\_ingredients.c}!halo\_bias@{halo\_bias}}
\index{halo\_bias@{halo\_bias}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{halo\_bias()}{halo\_bias()}}
{\footnotesize\ttfamily void halo\+\_\+bias (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{double}]{M,  }\item[{double}]{z,  }\item[{long}]{mode\+\_\+mf,  }\item[{double $\ast$}]{bias\+\_\+arr }\end{DoxyParamCaption})}



computes the halo biases for three mass functions, press-\/schecter, Sheth-\/\+Tormen, and Tinker mass functions 


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: \mbox{\hyperlink{struct_cosmology}{Cosmology}} structure \\
\hline
{\em M} & Input\+: halo mass \\
\hline
{\em z} & Input\+: redshift \\
\hline
{\em mode\+\_\+mf} & Input\+: switch for setting the model of mass function, can be set to PSC, ST, TR \\
\hline
{\em bias\+\_\+arr} & Output\+: the output array containning linear and quadratic local-\/in-\/matter halo biases, and quadratic and cubic tidal biases \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void ~\newline
 
\end{DoxyReturn}
Note that for PSC and ST mass functions, same form of the biases can be assumed, with different coefficents. See astro-\/ph/0006319

Assuming spherical collapseHere is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a5e747f325f7196b6c042ddcfdfb17fab_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a5e747f325f7196b6c042ddcfdfb17fab_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_aa4696edc9829e9a3c2c1012a3e9d9dbe}\label{line__ingredients_8c_aa4696edc9829e9a3c2c1012a3e9d9dbe}} 
\index{line\_ingredients.c@{line\_ingredients.c}!Line\_alloc\_init@{Line\_alloc\_init}}
\index{Line\_alloc\_init@{Line\_alloc\_init}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{Line\_alloc\_init()}{Line\_alloc\_init()}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{struct_line}{Line}} $\ast$ Line\+\_\+alloc\+\_\+init (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{long}]{line\+\_\+type,  }\item[{size\+\_\+t}]{npoints\+\_\+interp,  }\item[{double}]{M\+\_\+min,  }\item[{long}]{mode\+\_\+mf }\end{DoxyParamCaption})}



Allocate the memory and initialize the the line structure. 

This structure contains interpolators for computing the luminosity-\/weighted mass moments and line biases For a given line defined with \char`\"{}line\+\_\+type\char`\"{} variable, this function first computes the above four quantities for a wide range of redshifts. Next it iniialized 4 interpolators for these quantities, and store them in line structure.


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: \mbox{\hyperlink{struct_cosmology}{Cosmology}} structure \\
\hline
{\em line\+\_\+type} & Inpute\+: name of the line to compute. It can be set to CII, CO10, CO21, CO32, CO43, CO54, CO65 \\
\hline
{\em npoints\+\_\+interp} & Input\+: number of interpolation points \\
\hline
{\em M\+\_\+min} & Input\+: minimum halo mass for mass integrals \\
\hline
{\em mode\+\_\+mf} & Inpute\+: theoretical model of halo mass function to use. It can be set to sheth-\/\+Tormen (ST), Tinker (TR) or Press-\/\+Schecter (PSC) \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the total clustering line power spectrum, including the 1-\/ and 2-\/halo term ~\newline
 
\end{DoxyReturn}
CIIHere is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_aa4696edc9829e9a3c2c1012a3e9d9dbe_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_aa4696edc9829e9a3c2c1012a3e9d9dbe_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_a3a13aa566fb639abeb29eae43e5fcfa8}\label{line__ingredients_8c_a3a13aa566fb639abeb29eae43e5fcfa8}} 
\index{line\_ingredients.c@{line\_ingredients.c}!line\_bias@{line\_bias}}
\index{line\_bias@{line\_bias}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{line\_bias()}{line\_bias()}}
{\footnotesize\ttfamily void line\+\_\+bias (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_line}{Line}} $\ast$}]{Lx,  }\item[{double}]{z,  }\item[{double $\ast$}]{result }\end{DoxyParamCaption})}



Compute the linear and quadratic line biases, accounting ffor the normalization w.\+r.\+t. 

the first mass moment


\begin{DoxyParams}{Parameters}
{\em Lx} & Input\+: Pointer to line structure \\
\hline
{\em z} & Input\+: Redshift \\
\hline
{\em result} & Input\+: a pointer to an array containing the results of b1\+\_\+line and b2\+\_\+line \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=251pt]{d7/d10/line__ingredients_8c_a3a13aa566fb639abeb29eae43e5fcfa8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a3a13aa566fb639abeb29eae43e5fcfa8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_a0b51100183117f08ce0cfa9428fa72e4}\label{line__ingredients_8c_a0b51100183117f08ce0cfa9428fa72e4}} 
\index{line\_ingredients.c@{line\_ingredients.c}!Line\_evaluate@{Line\_evaluate}}
\index{Line\_evaluate@{Line\_evaluate}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{Line\_evaluate()}{Line\_evaluate()}}
{\footnotesize\ttfamily int Line\+\_\+evaluate (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_line}{Line}} $\ast$}]{Lx,  }\item[{double $\ast$}]{zz,  }\item[{double $\ast$}]{res }\end{DoxyParamCaption})}



Allocate the memory and initialize the the line structure. 

This structure contains interpolators for computing the luminosity-\/weighted mass moments and line biases For a given line defined with \char`\"{}line\+\_\+type\char`\"{} variable, this function first computes the above four quantities for a wide range of redshifts. Next it iniialized 4 interpolators for these quantities, and store them in line structure.


\begin{DoxyParams}{Parameters}
{\em Lx} & Input\+: Pointer to the line structure \\
\hline
{\em zz} & Input\+: this is an array with 4 elements to determine which of the 4 interpolators should be evaluated.
\begin{DoxyItemize}
\item If any of the elements are set to DO\+\_\+\+NOT\+\_\+\+EVALUATE, the quantitiy corresponding to that index is not computed. O
\item If any of the elements is set to z, the corresponding quantity would be evaluated at that redshift 
\end{DoxyItemize}\\
\hline
{\em res} & Output\+: an array containing the results. The number of elements of this array depends on how the zz array is set. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the error status 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a0b51100183117f08ce0cfa9428fa72e4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_a255599f7e846dd569f4ce4c946157dec}\label{line__ingredients_8c_a255599f7e846dd569f4ce4c946157dec}} 
\index{line\_ingredients.c@{line\_ingredients.c}!Line\_free@{Line\_free}}
\index{Line\_free@{Line\_free}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{Line\_free()}{Line\_free()}}
{\footnotesize\ttfamily int Line\+\_\+free (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_line}{Line}} $\ast$}]{Lx }\end{DoxyParamCaption})}



Free the line structure. 


\begin{DoxyParams}{Parameters}
{\em Lx} & Input\+: Pointer to line structure \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the error status 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a255599f7e846dd569f4ce4c946157dec_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_aebdf0211b161d65ccf44536629df2b02}\label{line__ingredients_8c_aebdf0211b161d65ccf44536629df2b02}} 
\index{line\_ingredients.c@{line\_ingredients.c}!logSFR\_alloc\_init@{logSFR\_alloc\_init}}
\index{logSFR\_alloc\_init@{logSFR\_alloc\_init}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{logSFR\_alloc\_init()}{logSFR\_alloc\_init()}}
{\footnotesize\ttfamily int log\+SFR\+\_\+alloc\+\_\+init (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Allocate memory and initialize the 2d interpolator for the star formation rate of Behroozi et al 2013 as a function of halo mass and redshift. 

\begin{DoxyReturn}{Returns}
the error status 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_aebdf0211b161d65ccf44536629df2b02_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=336pt]{d7/d10/line__ingredients_8c_aebdf0211b161d65ccf44536629df2b02_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_a728fd0a19bc34645b8f8218464d178ef}\label{line__ingredients_8c_a728fd0a19bc34645b8f8218464d178ef}} 
\index{line\_ingredients.c@{line\_ingredients.c}!logSFR\_Behroozi@{logSFR\_Behroozi}}
\index{logSFR\_Behroozi@{logSFR\_Behroozi}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{logSFR\_Behroozi()}{logSFR\_Behroozi()}}
{\footnotesize\ttfamily double log\+SFR\+\_\+\+Behroozi (\begin{DoxyParamCaption}\item[{double}]{logM,  }\item[{double}]{z }\end{DoxyParamCaption})}



Evaluate the SFR interpolator object for a given value of mass and redshift. 


\begin{DoxyParams}{Parameters}
{\em logM} & Input\+: log10 of halo mass \\
\hline
{\em z} & Input\+: redshift \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
log10\+SFR ~\newline
 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a728fd0a19bc34645b8f8218464d178ef_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_a5cbbc00460ea99c79cf2f2f7efd0af5a}\label{line__ingredients_8c_a5cbbc00460ea99c79cf2f2f7efd0af5a}} 
\index{line\_ingredients.c@{line\_ingredients.c}!logSFR\_Behroozi\_read@{logSFR\_Behroozi\_read}}
\index{logSFR\_Behroozi\_read@{logSFR\_Behroozi\_read}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{logSFR\_Behroozi\_read()}{logSFR\_Behroozi\_read()}}
{\footnotesize\ttfamily void log\+SFR\+\_\+\+Behroozi\+\_\+read (\begin{DoxyParamCaption}\item[{double $\ast$}]{z\+\_\+arr,  }\item[{double $\ast$}]{log\+M\+\_\+arr,  }\item[{double $\ast$}]{log10\+SFR }\end{DoxyParamCaption})}



Read in the file for the star formation rate byy Behroozi et al 2013. 


\begin{DoxyParams}{Parameters}
{\em z\+\_\+arr} & Output\+: pointer to an array of redshifts read from the file \\
\hline
{\em log\+M\+\_\+arr} & Output\+: pointer to an array of halo masses read from the file \\
\hline
{\em log10\+SFR} & Output\+: pointer to an array of SFR read from the file \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void ~\newline
 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a5cbbc00460ea99c79cf2f2f7efd0af5a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a5cbbc00460ea99c79cf2f2f7efd0af5a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_a1d5765167555f21d8ae5eba187eb2aa8}\label{line__ingredients_8c_a1d5765167555f21d8ae5eba187eb2aa8}} 
\index{line\_ingredients.c@{line\_ingredients.c}!luminosity@{luminosity}}
\index{luminosity@{luminosity}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{luminosity()}{luminosity()}}
{\footnotesize\ttfamily double luminosity (\begin{DoxyParamCaption}\item[{double}]{M,  }\item[{double}]{z,  }\item[{long}]{mode\+\_\+lum }\end{DoxyParamCaption})}



Compute the line specific luminosity in unit of solar luminosity For CO ladder, I am using the fits in Table 4 of ??? et al ar\+Xiv\+:1508.\+05102, while for CII we use Silva et al ar\+Xiv\+: 


\begin{DoxyParams}{Parameters}
{\em M} & Input\+: halo mass \\
\hline
{\em z} & Input\+: redshift \\
\hline
{\em mode\+\_\+lum} & Inpute\+: which luminosity model, basically which line considered \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
line luminosity ~\newline
 
\end{DoxyReturn}
a = 1.\+37 Charilli

b = -\/1.\+74

in unit of K km/s pc$^\wedge$2

in unit of L\+\_\+sunHere is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=272pt]{d7/d10/line__ingredients_8c_a1d5765167555f21d8ae5eba187eb2aa8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a1d5765167555f21d8ae5eba187eb2aa8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_a2ca7a5add6fca8bd94165085f351f702}\label{line__ingredients_8c_a2ca7a5add6fca8bd94165085f351f702}} 
\index{line\_ingredients.c@{line\_ingredients.c}!mass\_func@{mass\_func}}
\index{mass\_func@{mass\_func}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{mass\_func()}{mass\_func()}}
{\footnotesize\ttfamily double mass\+\_\+func (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{double}]{M,  }\item[{double}]{z,  }\item[{long}]{mode\+\_\+mf }\end{DoxyParamCaption})}



Compute the halo mass function for Press-\/\+Schechter, Sheth-\/\+Tormen and Tinker models see Pillepich et al arxiv\+: 0811.\+4176 for the expressions. 


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: \mbox{\hyperlink{struct_cosmology}{Cosmology}} structure \\
\hline
{\em M} & Input\+: Halo mass function \\
\hline
{\em z} & Input\+: redshift \\
\hline
{\em mode\+\_\+mf} & Input\+: switch for setting the model of mass function, can be set to PSC, ST, TR \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the halo mass function in unit of halos per Mpc$^\wedge$3 per solar mass, compared at z=0 with Murray etal \href{https://arxiv.org/abs/1306.5140}{\texttt{ https\+://arxiv.\+org/abs/1306.\+5140}} 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a2ca7a5add6fca8bd94165085f351f702_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a2ca7a5add6fca8bd94165085f351f702_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_a60bf4840dc0204947ec426719979065e}\label{line__ingredients_8c_a60bf4840dc0204947ec426719979065e}} 
\index{line\_ingredients.c@{line\_ingredients.c}!mass\_func\_sims@{mass\_func\_sims}}
\index{mass\_func\_sims@{mass\_func\_sims}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{mass\_func\_sims()}{mass\_func\_sims()}}
{\footnotesize\ttfamily double mass\+\_\+func\+\_\+sims (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{double}]{M,  }\item[{double}]{z,  }\item[{long}]{mode\+\_\+mf }\end{DoxyParamCaption})}



Read in the measured mass function of Hidden-\/valey sims and build an interpolator for HMF(\+M) for a fixed redshift. 


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: \mbox{\hyperlink{struct_cosmology}{Cosmology}} structure \\
\hline
{\em M} & Input\+: halo mass \\
\hline
{\em z} & Input\+: redshift \\
\hline
{\em mode\+\_\+mf} & Input\+: switch for setting the model of mass function, can be set to PSC, ST, TR \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the interpolated measured halo mass function ~\newline
 M in unit of M\+\_\+sun and HMF in unit of \#-\/of-\/halos/\+Mpc$^\wedge$3/\+M\+\_\+sun 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=306pt]{d7/d10/line__ingredients_8c_a60bf4840dc0204947ec426719979065e_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_a4024cda73f4069d07113edd77ae35d4e}\label{line__ingredients_8c_a4024cda73f4069d07113edd77ae35d4e}} 
\index{line\_ingredients.c@{line\_ingredients.c}!mass\_moment1@{mass\_moment1}}
\index{mass\_moment1@{mass\_moment1}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{mass\_moment1()}{mass\_moment1()}}
{\footnotesize\ttfamily double mass\+\_\+moment1 (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{double}]{z,  }\item[{double}]{M\+\_\+min,  }\item[{long}]{mode\+\_\+mf,  }\item[{long}]{mode\+\_\+lum }\end{DoxyParamCaption})}



in unit of M\+\_\+sun/\+Mpc$^\wedge$3 

In units of solar mass;

In units of solar massHere is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a4024cda73f4069d07113edd77ae35d4e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a4024cda73f4069d07113edd77ae35d4e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_ab82b15c827d1213a94e3ff9ce4ddad32}\label{line__ingredients_8c_ab82b15c827d1213a94e3ff9ce4ddad32}} 
\index{line\_ingredients.c@{line\_ingredients.c}!mass\_moment1\_integ@{mass\_moment1\_integ}}
\index{mass\_moment1\_integ@{mass\_moment1\_integ}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{mass\_moment1\_integ()}{mass\_moment1\_integ()}}
{\footnotesize\ttfamily int mass\+\_\+moment1\+\_\+integ (\begin{DoxyParamCaption}\item[{unsigned}]{nd,  }\item[{const double $\ast$}]{x,  }\item[{void $\ast$}]{p,  }\item[{unsigned}]{fdim,  }\item[{double $\ast$}]{fvalue }\end{DoxyParamCaption})}



Compute the first luminosityy-\/weighted mass moment. 

The function \mbox{\hyperlink{line__ingredients_8c_ab82b15c827d1213a94e3ff9ce4ddad32}{mass\+\_\+moment1\+\_\+integ()}} is the integrand and \mbox{\hyperlink{line__ingredients_8c_a4024cda73f4069d07113edd77ae35d4e}{mass\+\_\+moment1()}} compute the moment


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: pointer to cosmology structure \\
\hline
{\em z} & Input\+: redshift \\
\hline
{\em M\+\_\+min} & Input\+: minimum halo mass \\
\hline
{\em mode\+\_\+mf} & Input\+: model of halo mass function to consider, PSC, ST, TR \\
\hline
{\em mode\+\_\+lum} & Inpute\+: which luminosity model, basically which line considered \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the first mass moment ~\newline
 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_ab82b15c827d1213a94e3ff9ce4ddad32_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_ab82b15c827d1213a94e3ff9ce4ddad32_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_a905f3fe9b824af5ce217f36af3c767e5}\label{line__ingredients_8c_a905f3fe9b824af5ce217f36af3c767e5}} 
\index{line\_ingredients.c@{line\_ingredients.c}!mass\_moment2@{mass\_moment2}}
\index{mass\_moment2@{mass\_moment2}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{mass\_moment2()}{mass\_moment2()}}
{\footnotesize\ttfamily double mass\+\_\+moment2 (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{double}]{z,  }\item[{double}]{M\+\_\+min,  }\item[{long}]{mode\+\_\+mf,  }\item[{long}]{mode\+\_\+lum }\end{DoxyParamCaption})}



in unit of M\+\_\+sun/\+Mpc$^\wedge$3 

In units of solar mass;

In units of solar massHere is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a905f3fe9b824af5ce217f36af3c767e5_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a905f3fe9b824af5ce217f36af3c767e5_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_af293c79ca858df80dcc0ef9f29448059}\label{line__ingredients_8c_af293c79ca858df80dcc0ef9f29448059}} 
\index{line\_ingredients.c@{line\_ingredients.c}!mass\_moment2\_integ@{mass\_moment2\_integ}}
\index{mass\_moment2\_integ@{mass\_moment2\_integ}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{mass\_moment2\_integ()}{mass\_moment2\_integ()}}
{\footnotesize\ttfamily int mass\+\_\+moment2\+\_\+integ (\begin{DoxyParamCaption}\item[{unsigned}]{nd,  }\item[{const double $\ast$}]{x,  }\item[{void $\ast$}]{p,  }\item[{unsigned}]{fdim,  }\item[{double $\ast$}]{fvalue }\end{DoxyParamCaption})}



Compute the second luminosityy-\/weighted mass moment. 

The function \mbox{\hyperlink{line__ingredients_8c_af293c79ca858df80dcc0ef9f29448059}{mass\+\_\+moment2\+\_\+integ()}} is the integrand and \mbox{\hyperlink{line__ingredients_8c_a905f3fe9b824af5ce217f36af3c767e5}{mass\+\_\+moment2()}} compute the moment


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: pointer to cosmology structure \\
\hline
{\em z} & Input\+: redshift \\
\hline
{\em M\+\_\+min} & Input\+: minimum halo mass \\
\hline
{\em mode\+\_\+mf} & Input\+: model of halo mass function to consider, PSC, ST, TR \\
\hline
{\em mode\+\_\+lum} & Inpute\+: which luminosity model, basically which line considered \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the second mass moment ~\newline
 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_af293c79ca858df80dcc0ef9f29448059_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_af293c79ca858df80dcc0ef9f29448059_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_a01a848b612006614576adc49385076cf}\label{line__ingredients_8c_a01a848b612006614576adc49385076cf}} 
\index{line\_ingredients.c@{line\_ingredients.c}!mean\_intens@{mean\_intens}}
\index{mean\_intens@{mean\_intens}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{mean\_intens()}{mean\_intens()}}
{\footnotesize\ttfamily double mean\+\_\+intens (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{size\+\_\+t}]{line\+\_\+id,  }\item[{double}]{z }\end{DoxyParamCaption})}



Compute the line mean intensity in unit of erg Mpc$^\wedge$-\/2 Sr$^\wedge$-\/1. 


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: Pointer to cosmology structure \\
\hline
{\em line\+\_\+id} & Inpute\+: id of line of interest, an integer value \\
\hline
{\em z} & Input\+: Redshift \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the line mean intensity 
\end{DoxyReturn}
Note\+: nu\+\_\+J is the rest-\/frame emission frequency related to the observed frequency as nu\+\_\+obs = nu\+\_\+\+J/(1+z\+\_\+J) For a CO transition from J-\/\texorpdfstring{$>$}{>} J-\/1, the rest-\/frame frequency is nu\+\_\+J = J nu\+\_\+\+CO where nu\+\_\+\+Co = 115 GHz. ~\newline


in unit of erg/sHere is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=269pt]{d7/d10/line__ingredients_8c_a01a848b612006614576adc49385076cf_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a01a848b612006614576adc49385076cf_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_ae44a16b587a91c0ea92dea263d20a5be}\label{line__ingredients_8c_ae44a16b587a91c0ea92dea263d20a5be}} 
\index{line\_ingredients.c@{line\_ingredients.c}!mult\_func@{mult\_func}}
\index{mult\_func@{mult\_func}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{mult\_func()}{mult\_func()}}
{\footnotesize\ttfamily double mult\+\_\+func (\begin{DoxyParamCaption}\item[{double}]{sigma,  }\item[{long}]{mode\+\_\+mf }\end{DoxyParamCaption})}



Compute the multiplicity function needed to compute the halo mass function Three models are implemented\+: Press-\/\+Schechter, Sheth-\/\+Tormen and Tinker see Pillepich et al arxiv\+: 0811.\+4176 for the expressions. 


\begin{DoxyParams}{Parameters}
{\em sigma} & Input\+: variance of matter fluctuations \\
\hline
{\em mode\+\_\+mf} & Input\+: switch for setting the model of mass function, can be set to PSC, ST, TR \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the multiplicity function ~\newline
 
\end{DoxyReturn}
In Barkana \& Loeb Rev a = 0.\+75Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_ae44a16b587a91c0ea92dea263d20a5be_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_aac555bd341b096dfecd3cd915747b5a4}\label{line__ingredients_8c_aac555bd341b096dfecd3cd915747b5a4}} 
\index{line\_ingredients.c@{line\_ingredients.c}!p\_sig\_shot@{p\_sig\_shot}}
\index{p\_sig\_shot@{p\_sig\_shot}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{p\_sig\_shot()}{p\_sig\_shot()}}
{\footnotesize\ttfamily double p\+\_\+sig\+\_\+shot (\begin{DoxyParamCaption}\item[{double}]{scatter }\end{DoxyParamCaption})}

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=293pt]{d7/d10/line__ingredients_8c_aac555bd341b096dfecd3cd915747b5a4_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{d7/d10/line__ingredients_8c_aac555bd341b096dfecd3cd915747b5a4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_ac62e7dccfe1892b60f1709957e93d48c}\label{line__ingredients_8c_ac62e7dccfe1892b60f1709957e93d48c}} 
\index{line\_ingredients.c@{line\_ingredients.c}!p\_sig\_shot\_integrand@{p\_sig\_shot\_integrand}}
\index{p\_sig\_shot\_integrand@{p\_sig\_shot\_integrand}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{p\_sig\_shot\_integrand()}{p\_sig\_shot\_integrand()}}
{\footnotesize\ttfamily double p\+\_\+sig\+\_\+shot\+\_\+integrand (\begin{DoxyParamCaption}\item[{double}]{x,  }\item[{void $\ast$}]{par }\end{DoxyParamCaption})}



Model from Keating et al 2016 to account for the observed variation in halo activity, i.\+e. 

scatter in the L(\+M) relation p\+\_\+sig\+\_\+shot replaces the f\+\_\+duty in the shot-\/noise used in some LIM paper (ex. Lidz et al 2011). \mbox{\hyperlink{line__ingredients_8c_ac62e7dccfe1892b60f1709957e93d48c}{p\+\_\+sig\+\_\+shot\+\_\+integrand()}} is the integrand, and \mbox{\hyperlink{line__ingredients_8c_aac555bd341b096dfecd3cd915747b5a4}{p\+\_\+sig\+\_\+shot()}} computes the scatter factor for the shot noise.


\begin{DoxyParams}{Parameters}
{\em scatter} & Input\+: variance of the log-\/scatter \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the scatter coeff of the shot noise ~\newline
 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_ac62e7dccfe1892b60f1709957e93d48c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_a2bfb013c5be4f1c6d1ea0b91146b5f1c}\label{line__ingredients_8c_a2bfb013c5be4f1c6d1ea0b91146b5f1c}} 
\index{line\_ingredients.c@{line\_ingredients.c}!p\_sig\_Tbar@{p\_sig\_Tbar}}
\index{p\_sig\_Tbar@{p\_sig\_Tbar}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{p\_sig\_Tbar()}{p\_sig\_Tbar()}}
{\footnotesize\ttfamily double p\+\_\+sig\+\_\+\+Tbar (\begin{DoxyParamCaption}\item[{double}]{scatter }\end{DoxyParamCaption})}

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=297pt]{d7/d10/line__ingredients_8c_a2bfb013c5be4f1c6d1ea0b91146b5f1c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a2bfb013c5be4f1c6d1ea0b91146b5f1c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_a051e4cade75852a7abff94bce70a0307}\label{line__ingredients_8c_a051e4cade75852a7abff94bce70a0307}} 
\index{line\_ingredients.c@{line\_ingredients.c}!p\_sig\_Tbar\_integrand@{p\_sig\_Tbar\_integrand}}
\index{p\_sig\_Tbar\_integrand@{p\_sig\_Tbar\_integrand}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{p\_sig\_Tbar\_integrand()}{p\_sig\_Tbar\_integrand()}}
{\footnotesize\ttfamily double p\+\_\+sig\+\_\+\+Tbar\+\_\+integrand (\begin{DoxyParamCaption}\item[{double}]{x,  }\item[{void $\ast$}]{par }\end{DoxyParamCaption})}



Model from Keating et al 2016 to account for the observed variation in halo activity, i.\+e. 

scatter in the L(\+M) relation p\+\_\+sig\+\_\+\+Tbar replace the f\+\_\+duty in the average brightness temprature used in some LIM paper (ex. Lidz et al 2011). \mbox{\hyperlink{line__ingredients_8c_a051e4cade75852a7abff94bce70a0307}{p\+\_\+sig\+\_\+\+Tbar\+\_\+integrand()}} is the integrand, and \mbox{\hyperlink{line__ingredients_8c_a2bfb013c5be4f1c6d1ea0b91146b5f1c}{p\+\_\+sig\+\_\+\+Tbar()}} computes the scatter factor for the mean brightness temprature.


\begin{DoxyParams}{Parameters}
{\em scatter} & Input\+: variance of the log-\/scatter \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the scatter coeff of Tbar ~\newline
 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a051e4cade75852a7abff94bce70a0307_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_a6d006053a4f4af3c50b5c9a0b6365a8d}\label{line__ingredients_8c_a6d006053a4f4af3c50b5c9a0b6365a8d}} 
\index{line\_ingredients.c@{line\_ingredients.c}!SFR\_Behroozi\_free@{SFR\_Behroozi\_free}}
\index{SFR\_Behroozi\_free@{SFR\_Behroozi\_free}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{SFR\_Behroozi\_free()}{SFR\_Behroozi\_free()}}
{\footnotesize\ttfamily int SFR\+\_\+\+Behroozi\+\_\+free (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Free the memory allocated to the interpolators of star formation rate by Behroozi et al 2013. 

\begin{DoxyReturn}{Returns}
the error status 
\end{DoxyReturn}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a6d006053a4f4af3c50b5c9a0b6365a8d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{line__ingredients_8c_a8badf96f7e0696daa78b2f6aeeda8a08}\label{line__ingredients_8c_a8badf96f7e0696daa78b2f6aeeda8a08}} 
\index{line\_ingredients.c@{line\_ingredients.c}!Tbar\_line@{Tbar\_line}}
\index{Tbar\_line@{Tbar\_line}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{Tbar\_line()}{Tbar\_line()}}
{\footnotesize\ttfamily double Tbar\+\_\+line (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{size\+\_\+t}]{line\+\_\+id,  }\item[{double}]{z }\end{DoxyParamCaption})}



Compute the mean brightness temprature of CO in unit of microK, compared with Pullen et al and Lidz et al 2011. 


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: Pointer to cosmology structure \\
\hline
{\em line\+\_\+id} & Inpute\+: id of line of interest, an integer value \\
\hline
{\em z} & Input\+: Redshift \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the line mean temprature assuming Rayleigh-\/\+Jeans limit 
\end{DoxyReturn}
Boltzmann constant in unit of erg K$^\wedge$-\/1

factor of 10$^\wedge$6 is the conversion factor from K to microKHere is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a8badf96f7e0696daa78b2f6aeeda8a08_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d7/d10/line__ingredients_8c_a8badf96f7e0696daa78b2f6aeeda8a08_icgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{line__ingredients_8c_a61c6674f2b410e126a682325ce5360c0}\label{line__ingredients_8c_a61c6674f2b410e126a682325ce5360c0}} 
\index{line\_ingredients.c@{line\_ingredients.c}!gb@{gb}}
\index{gb@{gb}!line\_ingredients.c@{line\_ingredients.c}}
\doxysubsubsection{\texorpdfstring{gb}{gb}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structglobals}{globals}} gb}

