\hypertarget{ps__line__hm_8c}{}\doxysubsection{ps\+\_\+line\+\_\+hm.\+c File Reference}
\label{ps__line__hm_8c}\index{ps\_line\_hm.c@{ps\_line\_hm.c}}


Documented halo-\/model computation of line power spectrum, including clustering and stochastic contributions beyond Poisson limit.  


{\ttfamily \#include \char`\"{}header.\+h\char`\"{}}\newline
Include dependency graph for ps\+\_\+line\+\_\+hm.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{df/d3e/ps__line__hm_8c__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \mbox{\hyperlink{ps__line__hm_8c_ab3acf266df779fd7b847b2ca641efa01}{PS\+\_\+line\+\_\+\+HM}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double k, double z, double M\+\_\+min, long mode\+\_\+mf, long line\+\_\+type, int line\+\_\+id)
\begin{DoxyCompactList}\small\item\em Compute the clustering contribution to the line power spectrum using halo-\/model. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{ps__line__hm_8c_ab3d6db65cacf00838ffc77e39ec93656}{PS\+\_\+shot\+\_\+\+HM}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double k, double z, double M\+\_\+min, double $\ast$input, long mode\+\_\+mf, long line\+\_\+type)
\begin{DoxyCompactList}\small\item\em Compute the shot noise contributions, including corrections beyond poisson limit (see 1706.\+08738 for more details) If nfw=1, the dependance of the power spectrum on the halo profile is neglected. \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{ps__line__hm_8c_a122b3706f795f51c64ab8a9dd40379e3}{mhmc\+\_\+integ}} (const int $\ast$ndim, const cubareal x\mbox{[}$\,$\mbox{]}, const int $\ast$ncomp, cubareal ff\mbox{[}$\,$\mbox{]}, void $\ast$p)
\begin{DoxyCompactList}\small\item\em Compute the corrections to mass integration of HM matter power spectrum. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ps__line__hm_8c_a3a71ccb997cf820c19eb64cedbf69a10}{mhmc}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double z, long mode\+\_\+mf, double $\ast$result)
\item 
static int \mbox{\hyperlink{ps__line__hm_8c_ad72b2846b2e235de535da531f2ee30da}{HM\+\_\+1h2h\+\_\+integ}} (const int $\ast$ndim, const cubareal x\mbox{[}$\,$\mbox{]}, const int $\ast$ncomp, cubareal ff\mbox{[}$\,$\mbox{]}, void $\ast$p)
\begin{DoxyCompactList}\small\item\em Compute the mass integrals to compute the 1-\/ and 1-\/halo line, line-\/matter and matter power spectrum If nfw=1, the dependance of the power spectrum on the halo profile is neglected. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{ps__line__hm_8c_a298eb563414c8e40e35481cb64c2f509}{HM\+\_\+1h2h}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double k, double z, double M\+\_\+min, long mode\+\_\+mf, long line\+\_\+type, long mode\+\_\+hm, double $\ast$result)
\begin{DoxyCompactList}\small\item\em in unit of M\+\_\+sun/\+Mpc$^\wedge$3 \end{DoxyCompactList}\item 
static int \mbox{\hyperlink{ps__line__hm_8c_a4e1bbff7f992103c9b1fa8f5abc1f408}{b22\+\_\+ls\+\_\+integrand}} (const int $\ast$ndim, const cubareal x\mbox{[}$\,$\mbox{]}, const int $\ast$ncomp, cubareal ff\mbox{[}$\,$\mbox{]}, void $\ast$p)
\begin{DoxyCompactList}\small\item\em Compute the large-\/scale limit of P\+\_\+b2b2 loop. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{ps__line__hm_8c_aebed249f1a0afb0c6f7bcadcd3f1f4ee}{b22\+\_\+ls}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double z)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structglobals}{globals}} \mbox{\hyperlink{ps__line__hm_8c_a61c6674f2b410e126a682325ce5360c0}{gb}}
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Documented halo-\/model computation of line power spectrum, including clustering and stochastic contributions beyond Poisson limit. 

Azadeh Moradinezhad Dizgah, November 4th 2021

This module has two main functions\+:
\begin{DoxyItemize}
\item \mbox{\hyperlink{ps__line__hm_8c_ab3acf266df779fd7b847b2ca641efa01}{PS\+\_\+line\+\_\+\+HM()}} to compute clustering (1-\/ and 2-\/halo terms). The 2-\/halo term, includes nonlinear corrections to halo power spectrum arising from nonlinearities of matter fluctuations and halo biases.
\item \mbox{\hyperlink{ps__line__hm_8c_ab3d6db65cacf00838ffc77e39ec93656}{PS\+\_\+shot\+\_\+\+HM()}} to compute the stochastic contrubutions beyond Poisson shot noise (see ar\+Xiv\+:1706.\+08738)
\end{DoxyItemize}

The other functions in these modules are utilities for computing the above two main functions.

In summary, the following functions can be called from other modules\+:
\begin{DoxyEnumerate}
\item \mbox{\hyperlink{ps__line__hm_8c_ab3acf266df779fd7b847b2ca641efa01}{PS\+\_\+line\+\_\+\+HM()}}
\item \mbox{\hyperlink{ps__line__hm_8c_ab3d6db65cacf00838ffc77e39ec93656}{PS\+\_\+shot\+\_\+\+HM()}}
\item \mbox{\hyperlink{ps__line__hm_8c_a3a71ccb997cf820c19eb64cedbf69a10}{mhmc()}} computes th corrections to mass integration of halo-\/model matter power spectrum
\item \mbox{\hyperlink{ps__line__hm_8c_a298eb563414c8e40e35481cb64c2f509}{HM\+\_\+1h2h()}} performs the mass integraks for computing 1-\/ and 2-\/halo terms of line-\/line, line-\/matter and matter-\/matter power spectra.
\item \mbox{\hyperlink{ps__line__hm_8c_aebed249f1a0afb0c6f7bcadcd3f1f4ee}{b22\+\_\+ls()}} computes the large-\/scale limit of P\+\_\+b2b2 loop which behaves like a constant and so contributes to the shot noise. 
\end{DoxyEnumerate}

\doxysubsubsection{Function Documentation}
\mbox{\Hypertarget{ps__line__hm_8c_aebed249f1a0afb0c6f7bcadcd3f1f4ee}\label{ps__line__hm_8c_aebed249f1a0afb0c6f7bcadcd3f1f4ee}} 
\index{ps\_line\_hm.c@{ps\_line\_hm.c}!b22\_ls@{b22\_ls}}
\index{b22\_ls@{b22\_ls}!ps\_line\_hm.c@{ps\_line\_hm.c}}
\doxyparagraph{\texorpdfstring{b22\_ls()}{b22\_ls()}}
{\footnotesize\ttfamily double b22\+\_\+ls (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{double}]{z }\end{DoxyParamCaption})}

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dd5/ps__line__hm_8c_aebed249f1a0afb0c6f7bcadcd3f1f4ee_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=200pt]{d1/dd5/ps__line__hm_8c_aebed249f1a0afb0c6f7bcadcd3f1f4ee_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{ps__line__hm_8c_a4e1bbff7f992103c9b1fa8f5abc1f408}\label{ps__line__hm_8c_a4e1bbff7f992103c9b1fa8f5abc1f408}} 
\index{ps\_line\_hm.c@{ps\_line\_hm.c}!b22\_ls\_integrand@{b22\_ls\_integrand}}
\index{b22\_ls\_integrand@{b22\_ls\_integrand}!ps\_line\_hm.c@{ps\_line\_hm.c}}
\doxyparagraph{\texorpdfstring{b22\_ls\_integrand()}{b22\_ls\_integrand()}}
{\footnotesize\ttfamily static int b22\+\_\+ls\+\_\+integrand (\begin{DoxyParamCaption}\item[{const int $\ast$}]{ndim,  }\item[{const cubareal}]{x\mbox{[}$\,$\mbox{]},  }\item[{const int $\ast$}]{ncomp,  }\item[{cubareal}]{ff\mbox{[}$\,$\mbox{]},  }\item[{void $\ast$}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Compute the large-\/scale limit of P\+\_\+b2b2 loop. 


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: \mbox{\hyperlink{struct_cosmology}{Cosmology}} structure \\
\hline
{\em z} & Input\+: redshift \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
b22\+\_\+ls 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dd5/ps__line__hm_8c_a4e1bbff7f992103c9b1fa8f5abc1f408_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=329pt]{d1/dd5/ps__line__hm_8c_a4e1bbff7f992103c9b1fa8f5abc1f408_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{ps__line__hm_8c_a298eb563414c8e40e35481cb64c2f509}\label{ps__line__hm_8c_a298eb563414c8e40e35481cb64c2f509}} 
\index{ps\_line\_hm.c@{ps\_line\_hm.c}!HM\_1h2h@{HM\_1h2h}}
\index{HM\_1h2h@{HM\_1h2h}!ps\_line\_hm.c@{ps\_line\_hm.c}}
\doxyparagraph{\texorpdfstring{HM\_1h2h()}{HM\_1h2h()}}
{\footnotesize\ttfamily void HM\+\_\+1h2h (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{double}]{k,  }\item[{double}]{z,  }\item[{double}]{M\+\_\+min,  }\item[{long}]{mode\+\_\+mf,  }\item[{long}]{line\+\_\+type,  }\item[{long}]{mode\+\_\+hm,  }\item[{double $\ast$}]{result }\end{DoxyParamCaption})}



in unit of M\+\_\+sun/\+Mpc$^\wedge$3 

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dd5/ps__line__hm_8c_a298eb563414c8e40e35481cb64c2f509_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=325pt]{d1/dd5/ps__line__hm_8c_a298eb563414c8e40e35481cb64c2f509_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{ps__line__hm_8c_ad72b2846b2e235de535da531f2ee30da}\label{ps__line__hm_8c_ad72b2846b2e235de535da531f2ee30da}} 
\index{ps\_line\_hm.c@{ps\_line\_hm.c}!HM\_1h2h\_integ@{HM\_1h2h\_integ}}
\index{HM\_1h2h\_integ@{HM\_1h2h\_integ}!ps\_line\_hm.c@{ps\_line\_hm.c}}
\doxyparagraph{\texorpdfstring{HM\_1h2h\_integ()}{HM\_1h2h\_integ()}}
{\footnotesize\ttfamily static int HM\+\_\+1h2h\+\_\+integ (\begin{DoxyParamCaption}\item[{const int $\ast$}]{ndim,  }\item[{const cubareal}]{x\mbox{[}$\,$\mbox{]},  }\item[{const int $\ast$}]{ncomp,  }\item[{cubareal}]{ff\mbox{[}$\,$\mbox{]},  }\item[{void $\ast$}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Compute the mass integrals to compute the 1-\/ and 1-\/halo line, line-\/matter and matter power spectrum If nfw=1, the dependance of the power spectrum on the halo profile is neglected. 

Otherwise, NFW halo profile is assumed


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: \mbox{\hyperlink{struct_cosmology}{Cosmology}} structure \\
\hline
{\em k} & Input\+: wavenumber in unit of 1/\+Mpc. \\
\hline
{\em z} & Input\+: redshift \\
\hline
{\em M\+\_\+min} & Input\+: minimum halo mass for mass integrals \\
\hline
{\em mode\+\_\+mf} & Input\+: theoretical model of halo mass function to use. It can be set to sheth-\/\+Tormen (ST), Tinker (TR) or Press-\/\+Schecter (PSC) \\
\hline
{\em line\+\_\+type} & Input\+: name of the line to compute. It can be set to CII, CO10, CO21, CO32, CO43, CO54, CO65 \\
\hline
{\em mode\+\_\+hm} & Input\+: a switch to decide whetehr to compute gthe mass integrations. It can be set to\+:
\begin{DoxyItemize}
\item LINE for line power spectrum,
\item LINEMATTER for line-\/matter cross spectrum
\item MATTER for matter power spectrum 
\end{DoxyItemize}\\
\hline
{\em results} & Output\+: anarray of the integration results. Number of elements varies depending on mode\+\_\+hm switch\+:
\begin{DoxyItemize}
\item 3 elements if mode\+\_\+hm = LINE,
\item 1 element if mode\+\_\+hm = LINEMATTER
\item 2 element if mode\+\_\+hm = MATTER esults\mbox{[}0\mbox{]}\+: correction to 1-\/halo term, result\mbox{[}1\mbox{]}\+: correcrions to 2-\/halo term assuming linear halo bias 
\end{DoxyItemize}\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
we assume the profile of both matter and line are NFW

integrand of line 1halo term

integrand of 2halo term proportional to b1, the linear local-\/in-\/matter halo bias

integrand of 1halo term of line-\/matter cross-\/spectrumHere is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dd5/ps__line__hm_8c_ad72b2846b2e235de535da531f2ee30da_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dd5/ps__line__hm_8c_ad72b2846b2e235de535da531f2ee30da_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{ps__line__hm_8c_a3a71ccb997cf820c19eb64cedbf69a10}\label{ps__line__hm_8c_a3a71ccb997cf820c19eb64cedbf69a10}} 
\index{ps\_line\_hm.c@{ps\_line\_hm.c}!mhmc@{mhmc}}
\index{mhmc@{mhmc}!ps\_line\_hm.c@{ps\_line\_hm.c}}
\doxyparagraph{\texorpdfstring{mhmc()}{mhmc()}}
{\footnotesize\ttfamily void mhmc (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{double}]{z,  }\item[{long}]{mode\+\_\+mf,  }\item[{double $\ast$}]{result }\end{DoxyParamCaption})}

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dd5/ps__line__hm_8c_a3a71ccb997cf820c19eb64cedbf69a10_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=309pt]{d1/dd5/ps__line__hm_8c_a3a71ccb997cf820c19eb64cedbf69a10_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{ps__line__hm_8c_a122b3706f795f51c64ab8a9dd40379e3}\label{ps__line__hm_8c_a122b3706f795f51c64ab8a9dd40379e3}} 
\index{ps\_line\_hm.c@{ps\_line\_hm.c}!mhmc\_integ@{mhmc\_integ}}
\index{mhmc\_integ@{mhmc\_integ}!ps\_line\_hm.c@{ps\_line\_hm.c}}
\doxyparagraph{\texorpdfstring{mhmc\_integ()}{mhmc\_integ()}}
{\footnotesize\ttfamily static int mhmc\+\_\+integ (\begin{DoxyParamCaption}\item[{const int $\ast$}]{ndim,  }\item[{const cubareal}]{x\mbox{[}$\,$\mbox{]},  }\item[{const int $\ast$}]{ncomp,  }\item[{cubareal}]{ff\mbox{[}$\,$\mbox{]},  }\item[{void $\ast$}]{p }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Compute the corrections to mass integration of HM matter power spectrum. 

The function \mbox{\hyperlink{ps__line__hm_8c_a122b3706f795f51c64ab8a9dd40379e3}{mhmc\+\_\+integ()}} defines the integrand to be used by Cuhre integration routine of CUBA library. \mbox{\hyperlink{ps__line__hm_8c_a3a71ccb997cf820c19eb64cedbf69a10}{mhmc()}} returns the corrections to 1-\/ and 2-\/halo terms performing the integration

When computing the matter power spectrum using halo-\/model, the mass integrations for 1-\/ and 2-\/loop terms get contributions from halos of all masses. For numerical computation, we need to impose a lower and upper integration limit. While the result of the integration are not sensitive to the upper bound (due to the fact that the mass function drops rapidly at high M\+\_\+h) the choice of the lower bound affects the results. We can compute the leading order corrections to the integral that are accurate up to (k R\+\_\+s)$^\wedge$2. (see App. A of ar\+Xiv\+:1511.\+02231 for more details.)


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: \mbox{\hyperlink{struct_cosmology}{Cosmology}} structure \\
\hline
{\em z} & Input\+: redshift \\
\hline
{\em mode\+\_\+mf} & Inpute\+: theoretical model of halo mass function to use. It can be set to Press-\/\+Schecter (PSC), sheth-\/\+Tormen (ST), Tinker (TR) \\
\hline
{\em results} & Output\+: a 2d array of the integration results,
\begin{DoxyItemize}
\item results\mbox{[}0\mbox{]}\+: correction to 1-\/halo term,
\item result\mbox{[}1\mbox{]}\+: correcrions to 2-\/halo term assuming linear halo bias 
\end{DoxyItemize}\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dd5/ps__line__hm_8c_a122b3706f795f51c64ab8a9dd40379e3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dd5/ps__line__hm_8c_a122b3706f795f51c64ab8a9dd40379e3_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{ps__line__hm_8c_ab3acf266df779fd7b847b2ca641efa01}\label{ps__line__hm_8c_ab3acf266df779fd7b847b2ca641efa01}} 
\index{ps\_line\_hm.c@{ps\_line\_hm.c}!PS\_line\_HM@{PS\_line\_HM}}
\index{PS\_line\_HM@{PS\_line\_HM}!ps\_line\_hm.c@{ps\_line\_hm.c}}
\doxyparagraph{\texorpdfstring{PS\_line\_HM()}{PS\_line\_HM()}}
{\footnotesize\ttfamily double PS\+\_\+line\+\_\+\+HM (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{double}]{k,  }\item[{double}]{z,  }\item[{double}]{M\+\_\+min,  }\item[{long}]{mode\+\_\+mf,  }\item[{long}]{line\+\_\+type,  }\item[{int}]{line\+\_\+id }\end{DoxyParamCaption})}



Compute the clustering contribution to the line power spectrum using halo-\/model. 

If nfw=1, the dependance of the power spectrum on the halo profile is neglected. Otherwise, NFW halo profile is assumed


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: pointer to \mbox{\hyperlink{struct_cosmology}{Cosmology}} structure \\
\hline
{\em k} & Input\+: wavenumber in unit of 1/\+Mpc. \\
\hline
{\em z} & Input\+: redshift \\
\hline
{\em M\+\_\+min} & Input\+: minimum halo mass for mass integrals \\
\hline
{\em mode\+\_\+mf} & Inpute\+: theoretical model of halo mass function to use. It can be set to sheth-\/\+Tormen (ST), Tinker (TR) or Press-\/\+Schecter (PSC) \\
\hline
{\em line\+\_\+type} & Inpute\+: name of the line to compute. It can be set to CII, CO10, CO21, CO32, CO43, CO54, CO65 \\
\hline
{\em line\+\_\+id} & Inpute\+: id of the line to be considered. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
P\+\_\+clust(k) ~\newline
 
\end{DoxyReturn}
Boltzmann constant in unit of erg K$^\wedge$-\/1

in unit of erg/s

CII

to plot the power spectrum in units of micro K$^\wedge$2 Mpc$^\wedge$3

in unit of M\+\_\+sun/\+Mpc$^\wedge$3Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dd5/ps__line__hm_8c_ab3acf266df779fd7b847b2ca641efa01_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=226pt]{d1/dd5/ps__line__hm_8c_ab3acf266df779fd7b847b2ca641efa01_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{ps__line__hm_8c_ab3d6db65cacf00838ffc77e39ec93656}\label{ps__line__hm_8c_ab3d6db65cacf00838ffc77e39ec93656}} 
\index{ps\_line\_hm.c@{ps\_line\_hm.c}!PS\_shot\_HM@{PS\_shot\_HM}}
\index{PS\_shot\_HM@{PS\_shot\_HM}!ps\_line\_hm.c@{ps\_line\_hm.c}}
\doxyparagraph{\texorpdfstring{PS\_shot\_HM()}{PS\_shot\_HM()}}
{\footnotesize\ttfamily double PS\+\_\+shot\+\_\+\+HM (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{double}]{k,  }\item[{double}]{z,  }\item[{double}]{M\+\_\+min,  }\item[{double $\ast$}]{input,  }\item[{long}]{mode\+\_\+mf,  }\item[{long}]{line\+\_\+type }\end{DoxyParamCaption})}



Compute the shot noise contributions, including corrections beyond poisson limit (see 1706.\+08738 for more details) If nfw=1, the dependance of the power spectrum on the halo profile is neglected. 

Otherwise, NFW halo profile is assumed


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: \mbox{\hyperlink{struct_cosmology}{Cosmology}} structure \\
\hline
{\em k} & Input\+: wavenumber in unit of 1/\+Mpc. \\
\hline
{\em z} & Input\+: redshift \\
\hline
{\em M\+\_\+min} & Input\+: minimum halo mass for mass integrals \\
\hline
{\em input} & inpute\+: an array of input values with 4 values, Tave\+\_\+line, b1\+\_\+line, pb22\+\_\+ls, line\+\_\+shot, rhom\+\_\+bar \\
\hline
{\em mode\+\_\+mf} & Inpute\+: theoretical model of halo mass function to use. It can be set to sheth-\/\+Tormen (ST), Tinker (TR) or Press-\/\+Schecter (PSC) \\
\hline
{\em line\+\_\+type} & Inpute\+: name of the line to compute. It can be set to CII, CO10, CO21, CO32, CO43, CO54, CO65 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
P\+\_\+stoch(k) ~\newline
 
\end{DoxyReturn}
Boltzmann constant in unit of erg K$^\wedge$-\/1

in unit of erg/s

CII

Since the following quantities do not depend on k, I am computing them once and pass them as input to this function

to plot the power spectrum in units of micro K$^\wedge$2 Mpc$^\wedge$3

in unit of M\+\_\+sun/\+Mpc$^\wedge$3

in unit of M\+\_\+sun/\+Mpc$^\wedge$3

in unit of M\+\_\+sun/\+Mpc$^\wedge$3Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d1/dd5/ps__line__hm_8c_ab3d6db65cacf00838ffc77e39ec93656_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=229pt]{d1/dd5/ps__line__hm_8c_ab3d6db65cacf00838ffc77e39ec93656_icgraph}
\end{center}
\end{figure}


\doxysubsubsection{Variable Documentation}
\mbox{\Hypertarget{ps__line__hm_8c_a61c6674f2b410e126a682325ce5360c0}\label{ps__line__hm_8c_a61c6674f2b410e126a682325ce5360c0}} 
\index{ps\_line\_hm.c@{ps\_line\_hm.c}!gb@{gb}}
\index{gb@{gb}!ps\_line\_hm.c@{ps\_line\_hm.c}}
\doxyparagraph{\texorpdfstring{gb}{gb}}
{\footnotesize\ttfamily struct \mbox{\hyperlink{structglobals}{globals}} gb}

