\hypertarget{ps__line__hm_8c}{}\doxysubsection{ps\+\_\+line\+\_\+hm.\+c File Reference}
\label{ps__line__hm_8c}\index{ps\_line\_hm.c@{ps\_line\_hm.c}}


Documented halo-\/model computation of line power spectrum, including clustering and stochastic contributions beyond Poisson limit.  


{\ttfamily \#include \char`\"{}header.\+h\char`\"{}}\newline
Include dependency graph for ps\+\_\+line\+\_\+hm.\+c\+:
% FIG 0
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \mbox{\hyperlink{ps__line__hm_8c_ab3acf266df779fd7b847b2ca641efa01}{PS\+\_\+line\+\_\+\+HM}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double k, double z, double M\+\_\+min, long mode\+\_\+mf, long line\+\_\+type, int line\+\_\+id)
\begin{DoxyCompactList}\small\item\em Compute the clustering contribution to the line power spectrum using halo-\/model. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{ps__line__hm_8c_ab3d6db65cacf00838ffc77e39ec93656}{PS\+\_\+shot\+\_\+\+HM}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double k, double z, double M\+\_\+min, double $\ast$input, long mode\+\_\+mf, long line\+\_\+type)
\begin{DoxyCompactList}\small\item\em Compute the shot noise contributions, including corrections beyond poisson limit (see 1706.\+08738 for more details) If nfw=1, the dependance of the power spectrum on the halo profile is neglected. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ps__line__hm_8c_a3a71ccb997cf820c19eb64cedbf69a10}\label{ps__line__hm_8c_a3a71ccb997cf820c19eb64cedbf69a10}} 
void {\bfseries mhmc} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double z, long mode\+\_\+mf, double $\ast$result)
\item 
\mbox{\Hypertarget{ps__line__hm_8c_a298eb563414c8e40e35481cb64c2f509}\label{ps__line__hm_8c_a298eb563414c8e40e35481cb64c2f509}} 
void {\bfseries HM\+\_\+1h2h} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double k, double z, double M\+\_\+min, long mode\+\_\+mf, long line\+\_\+type, long mode\+\_\+hm, double $\ast$result)
\begin{DoxyCompactList}\small\item\em in unit of M\+\_\+sun/\+Mpc$^\wedge$3 \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ps__line__hm_8c_aebed249f1a0afb0c6f7bcadcd3f1f4ee}\label{ps__line__hm_8c_aebed249f1a0afb0c6f7bcadcd3f1f4ee}} 
double {\bfseries b22\+\_\+ls} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double z)
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{ps__line__hm_8c_a61c6674f2b410e126a682325ce5360c0}\label{ps__line__hm_8c_a61c6674f2b410e126a682325ce5360c0}} 
struct \mbox{\hyperlink{structglobals}{globals}} {\bfseries gb}
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Documented halo-\/model computation of line power spectrum, including clustering and stochastic contributions beyond Poisson limit. 

Azadeh Moradinezhad Dizgah, November 4th 2021

This module has two main functions\+:
\begin{DoxyItemize}
\item \mbox{\hyperlink{ps__line__hm_8c_ab3acf266df779fd7b847b2ca641efa01}{PS\+\_\+line\+\_\+\+HM()}} to compute clustering (1-\/ and 2-\/halo terms). The 2-\/halo term, includes nonlinear corrections to halo power spectrum arising from nonlinearities of matter fluctuations and halo biases.
\item \mbox{\hyperlink{ps__line__hm_8c_ab3d6db65cacf00838ffc77e39ec93656}{PS\+\_\+shot\+\_\+\+HM()}} to compute the stochastic contrubutions beyond Poisson shot noise (see ar\+Xiv\+:1706.\+08738)
\end{DoxyItemize}

The other functions in these modules are utilities for computing the above two main functions.

In summary, the following functions can be called from other modules\+:
\begin{DoxyEnumerate}
\item \mbox{\hyperlink{ps__line__hm_8c_ab3acf266df779fd7b847b2ca641efa01}{PS\+\_\+line\+\_\+\+HM()}}
\item \mbox{\hyperlink{ps__line__hm_8c_ab3d6db65cacf00838ffc77e39ec93656}{PS\+\_\+shot\+\_\+\+HM()}}
\item mhmc() computes th corrections to mass integration of halo-\/model matter power spectrum
\item \mbox{\hyperlink{ps__line__hm_8c_a298eb563414c8e40e35481cb64c2f509}{HM\+\_\+1h2h()}} performs the mass integraks for computing 1-\/ and 2-\/halo terms of line-\/line, line-\/matter and matter-\/matter power spectra.
\item b22\+\_\+ls() computes the large-\/scale limit of P\+\_\+b2b2 loop which behaves like a constant and so contributes to the shot noise. 
\end{DoxyEnumerate}

\doxysubsubsection{Function Documentation}
\mbox{\Hypertarget{ps__line__hm_8c_ab3acf266df779fd7b847b2ca641efa01}\label{ps__line__hm_8c_ab3acf266df779fd7b847b2ca641efa01}} 
\index{ps\_line\_hm.c@{ps\_line\_hm.c}!PS\_line\_HM@{PS\_line\_HM}}
\index{PS\_line\_HM@{PS\_line\_HM}!ps\_line\_hm.c@{ps\_line\_hm.c}}
\doxyparagraph{\texorpdfstring{PS\_line\_HM()}{PS\_line\_HM()}}
{\footnotesize\ttfamily double PS\+\_\+line\+\_\+\+HM (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{double}]{k,  }\item[{double}]{z,  }\item[{double}]{M\+\_\+min,  }\item[{long}]{mode\+\_\+mf,  }\item[{long}]{line\+\_\+type,  }\item[{int}]{line\+\_\+id }\end{DoxyParamCaption})}



Compute the clustering contribution to the line power spectrum using halo-\/model. 

If nfw=1, the dependance of the power spectrum on the halo profile is neglected. Otherwise, NFW halo profile is assumed


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: pointer to \mbox{\hyperlink{struct_cosmology}{Cosmology}} structure \\
\hline
{\em k} & Input\+: wavenumber in unit of 1/\+Mpc. \\
\hline
{\em z} & Input\+: redshift \\
\hline
{\em M\+\_\+min} & Input\+: minimum halo mass for mass integrals \\
\hline
{\em mode\+\_\+mf} & Inpute\+: theoretical model of halo mass function to use. It can be set to sheth-\/\+Tormen (ST), Tinker (TR) or Press-\/\+Schecter (PSC) \\
\hline
{\em line\+\_\+type} & Inpute\+: name of the line to compute. It can be set to CII, CO10, CO21, CO32, CO43, CO54, CO65 \\
\hline
{\em line\+\_\+id} & Inpute\+: id of the line to be considered. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
P\+\_\+clust(k) ~\newline
 
\end{DoxyReturn}
Boltzmann constant in unit of erg K$^\wedge$-\/1

in unit of erg/s

CII

to plot the power spectrum in units of micro K$^\wedge$2 Mpc$^\wedge$3

in unit of M\+\_\+sun/\+Mpc$^\wedge$3Here is the call graph for this function\+:
% FIG 1
\mbox{\Hypertarget{ps__line__hm_8c_ab3d6db65cacf00838ffc77e39ec93656}\label{ps__line__hm_8c_ab3d6db65cacf00838ffc77e39ec93656}} 
\index{ps\_line\_hm.c@{ps\_line\_hm.c}!PS\_shot\_HM@{PS\_shot\_HM}}
\index{PS\_shot\_HM@{PS\_shot\_HM}!ps\_line\_hm.c@{ps\_line\_hm.c}}
\doxyparagraph{\texorpdfstring{PS\_shot\_HM()}{PS\_shot\_HM()}}
{\footnotesize\ttfamily double PS\+\_\+shot\+\_\+\+HM (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{double}]{k,  }\item[{double}]{z,  }\item[{double}]{M\+\_\+min,  }\item[{double $\ast$}]{input,  }\item[{long}]{mode\+\_\+mf,  }\item[{long}]{line\+\_\+type }\end{DoxyParamCaption})}



Compute the shot noise contributions, including corrections beyond poisson limit (see 1706.\+08738 for more details) If nfw=1, the dependance of the power spectrum on the halo profile is neglected. 

Otherwise, NFW halo profile is assumed


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: \mbox{\hyperlink{struct_cosmology}{Cosmology}} structure \\
\hline
{\em k} & Input\+: wavenumber in unit of 1/\+Mpc. \\
\hline
{\em z} & Input\+: redshift \\
\hline
{\em M\+\_\+min} & Input\+: minimum halo mass for mass integrals \\
\hline
{\em input} & inpute\+: an array of input values with 4 values, Tave\+\_\+line, b1\+\_\+line, pb22\+\_\+ls, line\+\_\+shot, rhom\+\_\+bar \\
\hline
{\em mode\+\_\+mf} & Inpute\+: theoretical model of halo mass function to use. It can be set to sheth-\/\+Tormen (ST), Tinker (TR) or Press-\/\+Schecter (PSC) \\
\hline
{\em line\+\_\+type} & Inpute\+: name of the line to compute. It can be set to CII, CO10, CO21, CO32, CO43, CO54, CO65 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
P\+\_\+stoch(k) ~\newline
 
\end{DoxyReturn}
Boltzmann constant in unit of erg K$^\wedge$-\/1

in unit of erg/s

CII

Since the following quantities do not depend on k, I am computing them once and pass them as input to this function

to plot the power spectrum in units of micro K$^\wedge$2 Mpc$^\wedge$3

in unit of M\+\_\+sun/\+Mpc$^\wedge$3

in unit of M\+\_\+sun/\+Mpc$^\wedge$3

in unit of M\+\_\+sun/\+Mpc$^\wedge$3