\hypertarget{ps__line__pt_8c}{}\doxysubsection{ps\+\_\+line\+\_\+pt.\+c File Reference}
\label{ps__line__pt_8c}\index{ps\_line\_pt.c@{ps\_line\_pt.c}}


Documented computation of Poisson shot noise and tree-\/level line power spectrum in real and redshift-\/space.  


{\ttfamily \#include \char`\"{}header.\+h\char`\"{}}\newline
Include dependency graph for ps\+\_\+line\+\_\+pt.\+c\+:
% FIG 0
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
double \mbox{\hyperlink{ps__line__pt_8c_adb0db1c5916a39f0b796a30b48b03f42}{PS\+\_\+line}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double k, double z, size\+\_\+t line\+\_\+id)
\begin{DoxyCompactList}\small\item\em Compute the real-\/space 3D power spectrum of emission lines in unit of micro K$^\wedge$2 Mpc$^\wedge$3. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{ps__line__pt_8c_a2a5a8e5016f2d8728844564d93000751}{PS\+\_\+line\+\_\+\+RSD}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx\+\_\+ref, double k, double mu, double z, size\+\_\+t line\+\_\+id)
\begin{DoxyCompactList}\small\item\em Compute the redshift-\/space 3D power spectrum of emission lines in unit of micro K$^\wedge$2 Mpc$^\wedge$3 as a function of wavenumber and angle w.\+r.\+t. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{ps__line__pt_8c_ae4ce1e29b505dae588eb2b8c8ae632e2}{ps\+\_\+line\+\_\+multipoles\+\_\+integrand}} (unsigned ndim, const double $\ast$x, void $\ast$p, unsigned fdim, double $\ast$fvalue)
\begin{DoxyCompactList}\small\item\em Compute the multipole moments of redshift-\/space power spectrum of emission lines in unit of micro K$^\wedge$2 Mpc$^\wedge$3, integrating over the angle w.\+r.\+t LOS, weighted by. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{ps__line__pt_8c_a62cf452e70a5c44e79485391ad59cf63}\label{ps__line__pt_8c_a62cf452e70a5c44e79485391ad59cf63}} 
double {\bfseries ps\+\_\+line\+\_\+multipoles} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx\+\_\+ref, double k, double z, size\+\_\+t line\+\_\+id, int ell)
\item 
double \mbox{\hyperlink{ps__line__pt_8c_aef342e8a0e97c247ed892896732d0dcd}{PS\+\_\+shot}} (struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$Cx, double z, size\+\_\+t line\+\_\+id)
\begin{DoxyCompactList}\small\item\em Compute the Poisson shot noise in unit of micro K$^\wedge$2 Mpc$^\wedge$3. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{ps__line__pt_8c_a61c6674f2b410e126a682325ce5360c0}\label{ps__line__pt_8c_a61c6674f2b410e126a682325ce5360c0}} 
struct \mbox{\hyperlink{structglobals}{globals}} {\bfseries gb}
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
Documented computation of Poisson shot noise and tree-\/level line power spectrum in real and redshift-\/space. 

Azadeh Moradinezhad Dizgah, November 4th 2021

NOTE TODO\+: Add the 1loop redshift-\/space power spectrum of the line. This requires implementing FFTLog, still in progress For the moment we stick to the tree-\/level expression of line power spectrum in redshift-\/space.

In summary, the following functions can be called from other modules\+:
\begin{DoxyEnumerate}
\item \mbox{\hyperlink{ps__line__pt_8c_adb0db1c5916a39f0b796a30b48b03f42}{PS\+\_\+line()}} computes tree-\/level line power spectrum in real-\/space
\item \mbox{\hyperlink{ps__line__pt_8c_a2a5a8e5016f2d8728844564d93000751}{PS\+\_\+line\+\_\+\+RSD()}} computes the tree-\/level line power spectrum in redshift-\/space, as a function of wavenumber and angle w.\+r.\+t LOS
\item ps\+\_\+line\+\_\+multipoles() computes the redshift-\/space multipoles of the line power spectrum
\item \mbox{\hyperlink{ps__line__pt_8c_aef342e8a0e97c247ed892896732d0dcd}{PS\+\_\+shot()}} computes the poisson shot noise 
\end{DoxyEnumerate}

\doxysubsubsection{Function Documentation}
\mbox{\Hypertarget{ps__line__pt_8c_adb0db1c5916a39f0b796a30b48b03f42}\label{ps__line__pt_8c_adb0db1c5916a39f0b796a30b48b03f42}} 
\index{ps\_line\_pt.c@{ps\_line\_pt.c}!PS\_line@{PS\_line}}
\index{PS\_line@{PS\_line}!ps\_line\_pt.c@{ps\_line\_pt.c}}
\doxyparagraph{\texorpdfstring{PS\_line()}{PS\_line()}}
{\footnotesize\ttfamily double PS\+\_\+line (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{double}]{k,  }\item[{double}]{z,  }\item[{size\+\_\+t}]{line\+\_\+id }\end{DoxyParamCaption})}



Compute the real-\/space 3D power spectrum of emission lines in unit of micro K$^\wedge$2 Mpc$^\wedge$3. 


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: \mbox{\hyperlink{struct_cosmology}{Cosmology}} structure \\
\hline
{\em k} & Input\+: wavenumber in unit of 1/\+Mpc. \\
\hline
{\em z} & Input\+: redshift \\
\hline
{\em line\+\_\+id} & Inpute\+: id of the line to be considered. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
tree-\/level P\+\_\+clust(k) ~\newline
 
\end{DoxyReturn}
Here is the call graph for this function\+:
% FIG 1
\mbox{\Hypertarget{ps__line__pt_8c_ae4ce1e29b505dae588eb2b8c8ae632e2}\label{ps__line__pt_8c_ae4ce1e29b505dae588eb2b8c8ae632e2}} 
\index{ps\_line\_pt.c@{ps\_line\_pt.c}!ps\_line\_multipoles\_integrand@{ps\_line\_multipoles\_integrand}}
\index{ps\_line\_multipoles\_integrand@{ps\_line\_multipoles\_integrand}!ps\_line\_pt.c@{ps\_line\_pt.c}}
\doxyparagraph{\texorpdfstring{ps\_line\_multipoles\_integrand()}{ps\_line\_multipoles\_integrand()}}
{\footnotesize\ttfamily int ps\+\_\+line\+\_\+multipoles\+\_\+integrand (\begin{DoxyParamCaption}\item[{unsigned}]{ndim,  }\item[{const double $\ast$}]{x,  }\item[{void $\ast$}]{p,  }\item[{unsigned}]{fdim,  }\item[{double $\ast$}]{fvalue }\end{DoxyParamCaption})}



Compute the multipole moments of redshift-\/space power spectrum of emission lines in unit of micro K$^\wedge$2 Mpc$^\wedge$3, integrating over the angle w.\+r.\+t LOS, weighted by. 


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: \mbox{\hyperlink{struct_cosmology}{Cosmology}} structure \\
\hline
{\em Cx\+\_\+ref} & Input\+: Reference cosmology structure, needed for AP effect \\
\hline
{\em k} & Input\+: wavenumber in unit of 1/\+Mpc. \\
\hline
{\em z} & Input\+: redshift \\
\hline
{\em line\+\_\+id} & Inpute\+: id of the line to be considered. \\
\hline
{\em ell} & Inpute\+: the multipole \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
P\+\_\+ell(k) ~\newline
 
\end{DoxyReturn}
Here is the call graph for this function\+:
% FIG 2
\mbox{\Hypertarget{ps__line__pt_8c_a2a5a8e5016f2d8728844564d93000751}\label{ps__line__pt_8c_a2a5a8e5016f2d8728844564d93000751}} 
\index{ps\_line\_pt.c@{ps\_line\_pt.c}!PS\_line\_RSD@{PS\_line\_RSD}}
\index{PS\_line\_RSD@{PS\_line\_RSD}!ps\_line\_pt.c@{ps\_line\_pt.c}}
\doxyparagraph{\texorpdfstring{PS\_line\_RSD()}{PS\_line\_RSD()}}
{\footnotesize\ttfamily double PS\+\_\+line\+\_\+\+RSD (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx\+\_\+ref,  }\item[{double}]{k,  }\item[{double}]{mu,  }\item[{double}]{z,  }\item[{size\+\_\+t}]{line\+\_\+id }\end{DoxyParamCaption})}



Compute the redshift-\/space 3D power spectrum of emission lines in unit of micro K$^\wedge$2 Mpc$^\wedge$3 as a function of wavenumber and angle w.\+r.\+t. 

LOS


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: \mbox{\hyperlink{struct_cosmology}{Cosmology}} structure \\
\hline
{\em Cx\+\_\+ref} & Input\+: Reference cosmology structure, needed for AP effect \\
\hline
{\em k} & Input\+: wavenumber in unit of 1/\+Mpc. \\
\hline
{\em mu} & Inpute\+: angle w.\+r.\+t LOS \\
\hline
{\em z} & Input\+: redshift \\
\hline
{\em line\+\_\+id} & Inpute\+: id of the line to be considered. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
tree-\/level P\+\_\+clust(k,mu) ~\newline
 
\end{DoxyReturn}
to plot the power spectrum in units of micro K$^\wedge$2 Mpc$^\wedge$3Here is the call graph for this function\+:
% FIG 3
Here is the caller graph for this function\+:
% FIG 4
\mbox{\Hypertarget{ps__line__pt_8c_aef342e8a0e97c247ed892896732d0dcd}\label{ps__line__pt_8c_aef342e8a0e97c247ed892896732d0dcd}} 
\index{ps\_line\_pt.c@{ps\_line\_pt.c}!PS\_shot@{PS\_shot}}
\index{PS\_shot@{PS\_shot}!ps\_line\_pt.c@{ps\_line\_pt.c}}
\doxyparagraph{\texorpdfstring{PS\_shot()}{PS\_shot()}}
{\footnotesize\ttfamily double PS\+\_\+shot (\begin{DoxyParamCaption}\item[{struct \mbox{\hyperlink{struct_cosmology}{Cosmology}} $\ast$}]{Cx,  }\item[{double}]{z,  }\item[{size\+\_\+t}]{line\+\_\+id }\end{DoxyParamCaption})}



Compute the Poisson shot noise in unit of micro K$^\wedge$2 Mpc$^\wedge$3. 


\begin{DoxyParams}{Parameters}
{\em Cx} & Input\+: \mbox{\hyperlink{struct_cosmology}{Cosmology}} structure \\
\hline
{\em z} & Input\+: redshift \\
\hline
{\em line\+\_\+id} & Inpute\+: id of the line to be considered. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
P\+\_\+poisson ~\newline
 in unit of micro K$^\wedge$2 Mpc$^\wedge$3 
\end{DoxyReturn}
Boltzmann constant in unit of erg K$^\wedge$-\/1

in unit of erg/s